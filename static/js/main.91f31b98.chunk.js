(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var i=n(1),c=n.n(i),a=n(9),o=n.n(a),r=(n(14),n(3)),l=n(2),s=(n(15),n(0)),d=function(e){var t=e.distance,n=void 0===t?0:t,c=e.time,a=void 0===c?0:c,o=e.state,r=void 0===o?0:o,l=Object(i.useMemo)((function(){return"".concat(a/1e3)}),[a]);return Object(s.jsx)("div",{style:u.container,children:Object(s.jsxs)("div",{style:u.distanceWrap,children:[Object(s.jsx)("div",{style:u.label,children:"Distance"}),Object(s.jsx)("div",{style:u.distance,children:(n||0).toFixed(2)}),Object(s.jsx)("div",{style:u.unit,children:"Inches"}),r>0&&Object(s.jsxs)("div",{style:u.timer,children:["Timer: ",l,"s"]})]})})},u={container:{display:"flex",flexDirection:"column",flex:1,padding:15},title:{fontSize:24},distanceWrap:{display:"flex",flexDirection:"column",flex:1,alignItems:"center",justifyContent:"center"},label:{fontSize:30},distance:{fontSize:100},unit:{fontSize:30},timer:{marginTop:30,fontSize:35,marginBottom:30}},m=n(5),f=n(7),b=n.n(f),j=function(e){var t=e.data,n=e.keyExtractor,i=e.renderItem;return Object(s.jsx)("div",{children:t.map((function(e,t){var c=n(e,t);return Object(s.jsx)("div",{children:i({item:e,index:t})},c)}))})},g=function(e){var t=e.data,n=void 0===t?[]:t,c=e.clearLogs,a=e.names,o=e.setNames,d=e.selectedName,u=(e.setSelectedName,e.onChangeName),f=e.setLogs,g=Object(i.useState)(""),v=Object(l.a)(g,2),O=v[0],h=v[1],p=Object(i.useState)(b()().format("YYYY-MM-DD")),y=Object(l.a)(p,2),S=y[0],C=y[1],T=n.filter((function(e){return e.name===d&&b()(e.dateTime).isSame(S,"date")}));return Object(s.jsxs)("div",{style:x.container,children:[Object(s.jsx)("div",{style:{marginBottom:10},children:Object(s.jsx)("input",{type:"date",value:S,onChange:function(e){return C(e.target.value)}})}),Object(s.jsxs)("div",{style:{marginBottom:10},children:[Object(s.jsx)("input",{value:O,onChange:function(e){return h(e.target.value)}}),Object(s.jsx)("button",{onClick:function(){""!==O&&(void 0===a.find((function(e){return e===O}))?(o((function(e){var t=[].concat(Object(m.a)(e),[O]);return localStorage.setItem("names",JSON.stringify(t)),t})),h("")):alert("User '"+O+"' already exists."))},children:"+ Add"})]}),Object(s.jsx)("div",{style:x.nameRow,children:a.map((function(e){return Object(s.jsxs)("div",{style:e===d?x.activeTag:x.tag,children:[Object(s.jsx)("span",{onClick:function(){return u(e)},children:e}),Object(s.jsx)("span",{style:{cursor:"pointer"},onClick:function(){"Default"!==e?window.confirm("Are you sure to delete user '"+e+"' ?")&&(f((function(t){var n=t.filter((function(t){return t.name!==e}));return localStorage.setItem("logs",JSON.stringify(n)),n})),o((function(t){var n=t.filter((function(t){return t!==e}));return localStorage.setItem("names",JSON.stringify(n)),n})),e===d&&u("Default")):alert("User '"+e+"' can not be deleted.")},children:"\u2612"})]})}))}),Object(s.jsx)("hr",{}),Object(s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(s.jsx)("button",{onClick:function(){window.confirm("Are you sure to clear all logs?")&&c()},children:"Clear"}),Object(s.jsx)("button",{onClick:function(){var e=n.filter((function(e){return b()(e.dateTime).isSame(S,"date")})),t=["No.,Date Time,Name,Distance(in.),Time(sec.),Point"].concat(Object(m.a)(e.map((function(e,t){return"".concat(t+1,",").concat(e.dateTime.toLocaleDateString("en-GB")," ").concat(e.dateTime.toLocaleTimeString("en-GB"),",").concat(e.name,",").concat((e.distance||0).toFixed(2),",").concat(e.time/1e3,",").concat(e.point)})))).join("\n"),i="data:text/csv;charset=utf-8,".concat(t),c=encodeURI(i),a=document.createElement("a");a.download="archery_export",a.href=c,a.click()},children:"Export"})]}),Object(s.jsxs)("div",{style:x.listItem,children:[Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},x.th),x.number),children:"No."}),Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},x.th),x.distance),children:"Distance (in.)"}),Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},x.th),x.time),children:"Time (sec.)"}),Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},x.th),x.point),children:"Point"}),Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},x.th),x.del)})]}),Object(s.jsx)(j,{data:T,keyExtractor:function(e,t){return t.toString()},renderItem:function(e){var t=e.item,n=e.index,i=t.time/1e3,c="".concat(i);return Object(s.jsxs)("div",{style:x.listItem,children:[Object(s.jsxs)("div",{style:x.number,children:["#",n+1]}),Object(s.jsx)("div",{style:x.distance,children:(t.distance||0).toFixed(2)}),Object(s.jsx)("div",{style:x.time,children:c}),Object(s.jsx)("input",{style:x.point,value:t.point,onChange:function(e){f((function(n){var i=n.map((function(n){return n.uuid===t.uuid&&(n.point=e.target.value),n}));return localStorage.setItem("logs",JSON.stringify(i)),i}))}}),Object(s.jsx)("div",{style:x.del,onClick:function(e){window.confirm("Are you sure to delete record #"+(n+1)+" ?")&&f((function(e){var n=e.filter((function(e){return e.uuid!==t.uuid}));return localStorage.setItem("logs",JSON.stringify(n)),n}))},children:"\u2612"})]})}})]})},x={container:{flex:1,padding:15,paddingBottom:100},title:{fontSize:24},listItem:{display:"flex",flexDirection:"row",paddingTop:5,paddingBottom:5},th:{fontWeight:"bold"},number:{flex:1,fontSize:20},distance:{flex:3,divAlign:"right",fontSize:20},time:{flex:3,divAlign:"right",fontSize:20},point:{flex:1,divAlign:"right",fontSize:20,textAlign:"center",width:1},del:{flex:1,divAlign:"right",fontSize:20,textAlign:"center"},tag:{border:"1px solid #d0d0d0",backgroundColor:"#fff",padding:5,width:"fit-content",display:"flex",gap:3},activeTag:{border:"3px solid lime",backgroundColor:"#d0d0d0",padding:5,width:"fit-content",display:"flex",gap:3},nameRow:{display:"flex",gap:5,flexWrap:"wrap"}},v=function(e){var t=e.alarmTimeMax,n=e.setAlarmTimeMax,c=e.alarmTimeMin,a=e.setAlarmTimeMin,o=e.onSaveAlarmTime,r=Object(i.useMemo)((function(){return t/1e3}),[t]),l=Object(i.useMemo)((function(){return c/1e3}),[c]);return Object(s.jsx)("div",{style:O.container,children:Object(s.jsxs)("div",{style:O.distanceWrap,children:[Object(s.jsx)("div",{style:O.label,children:"Set Maximum Aiming Time (sec.)"}),Object(s.jsx)("input",{type:"number",style:O.input,value:r,onChange:function(e){var t=1e3*+e.target.value;n(t)}}),Object(s.jsx)("div",{style:O.label,children:"Set Minimum Aiming Time (sec.)"}),Object(s.jsx)("input",{type:"number",style:O.input,value:l,onChange:function(e){var t=1e3*+e.target.value;a(t)}}),Object(s.jsx)("button",{style:O.button,onClick:o,children:"Save"})]})})},O={container:{display:"flex",flexDirection:"column",flex:1,padding:15},title:{fontSize:24},distanceWrap:{display:"flex",flexDirection:"column",flex:1,alignItems:"center",justifyContent:"center"},input:{fontSize:30,padding:10,margin:20,textAlign:"center",width:100},label:{fontSize:30,textAlign:"center"},button:{fontSize:20},distance:{fontSize:100},unit:{fontSize:30},timer:{marginTop:30,fontSize:35,marginBottom:30}},h="52cf0b2c-28f2-4328-aaac-6badc36777d4",p=function(){var e=Object(i.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)(0),o=Object(l.a)(a,2),r=o[0],s=o[1],d=Object(i.useState)(0),u=Object(l.a)(d,2),f=u[0],b=u[1],j=Object(i.useState)([]),g=Object(l.a)(j,2),x=g[0],v=g[1],O=Object(i.useState)(0),p=Object(l.a)(O,2),y=p[0],S=p[1],C=Object(i.useState)(0),T=Object(l.a)(C,2),w=T[0],A=T[1],N=Object(i.useState)(0),k=Object(l.a)(N,2),D=k[0],M=k[1],L=Object(i.useState)([]),I=Object(l.a)(L,2),z=I[0],B=I[1],E=Object(i.useState)(),J=Object(l.a)(E,2),F=J[0],W=J[1],P=Object(i.useState)(null),R=Object(l.a)(P,2),U=R[0],Y=R[1],G=Object(i.useRef)(F),H=function(e){G.current=e,W(e)};Object(i.useEffect)((function(){var e=localStorage.getItem("logs"),t=e?JSON.parse(e):[];v(t);var n=localStorage.getItem("names"),i=n?JSON.parse(n):["Default"];B(i),H(null===i||void 0===i?void 0:i[0])}),[]);var V=Object(i.useCallback)((function(){v([]),localStorage.removeItem("logs")}),[]),_=Object(i.useCallback)((function(){n?alert("Already connected."):navigator.bluetooth.requestDevice({filters:[{name:"Arrow_ESP32"}],optionalServices:[h]}).then((function(e){return console.log({device:e}),e.addEventListener("gattserverdisconnected",(function(e){var t=e.target;c(!1),Y(null),alert("Device disconnected."),console.log("Device ".concat(t.name," is disconnected."))}),{once:!0}),e.gatt.connect()})).then((function(e){return console.log({server:e}),c(e.connected),e.getPrimaryService(h)})).then((function(e){return console.log({service:e}),e.getCharacteristic("051f540c-9a37-4284-9f98-2073e9f5bdfe")})).then((function(e){return console.log({characteristic:e}),Y(e),e.startNotifications()})).then((function(e){e.addEventListener("characteristicvaluechanged",(function(e){var t=e.target.value,n=new TextDecoder("utf-8").decode(t).split(","),i=Object(l.a)(n,3),c=i[0],a=i[1],o=i[2],r=+a,d=+o,u=+c;s(r),b(d),S(u),2===u&&v((function(e){var t=[].concat(Object(m.a)(e),[{distance:r,time:d,dateTime:new Date,name:G.current,point:"0",uuid:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}]);return localStorage.setItem("logs",JSON.stringify(t)),t}))})),console.log("Notifications have been started.")})).catch((function(e){console.error(e),window.location.reload()}))}),[n]),q=Object(i.useCallback)((function(e){H(e)}),[]);return{distance:r,time:f,logs:x,isConnected:n,scanAndConnect:_,clearLogs:V,state:y,alarmTimeMax:w,setAlarmTimeMax:A,alarmTimeMin:D,setAlarmTimeMin:M,onSaveAlarmTime:function(){if(n)if(w>=0&&D>=0){var e=w.toString(),t=D.toString(),i=new TextEncoder("utf-8");U.writeValue(i.encode(e+","+t)),alert("Saved !!!")}else alert("Time is not valid !!!");else alert("Please connect to the device.")},names:z,selectedName:F,setNames:B,setSelectedName:H,onChangeName:q,setLogs:v}};var y=function(){var e=p(),t=e.distance,n=e.time,c=e.logs,a=e.isConnected,o=e.scanAndConnect,u=e.clearLogs,m=e.state,f=e.alarmTimeMax,b=e.setAlarmTimeMax,j=e.alarmTimeMin,x=e.setAlarmTimeMin,O=e.onSaveAlarmTime,h=e.names,y=e.selectedName,C=e.setNames,T=e.setSelectedName,w=e.onChangeName,A=e.setLogs,N=Object(i.useState)("home"),k=Object(l.a)(N,2),D=k[0],M=k[1],L=Object(i.useMemo)((function(){return{home:{component:d,props:{distance:t,time:n,state:m}},logs:{component:g,props:{data:c,clearLogs:u,names:h,setNames:C,selectedName:y,setSelectedName:T,onChangeName:w,setLogs:A}},setting:{component:v,props:{alarmTimeMax:f,setAlarmTimeMax:b,alarmTimeMin:j,setAlarmTimeMin:x,onSaveAlarmTime:O}}}}),[c,t,n,u,m,f,b,j,x,O,h,C,y,T,w,A]),I=L[D].component,z=L[D].props;return Object(s.jsxs)("div",{style:S.container,children:[Object(s.jsxs)("div",{style:S.status,children:[Object(s.jsx)("div",{style:S.scanningdiv,children:a?"Connected":"Disconnected"}),Object(s.jsx)("button",{style:S.button,onClick:o,children:"Scan and Connect"})]}),Object(s.jsx)("div",{style:S.content,children:Object(s.jsx)(I,Object(r.a)({},z))}),Object(s.jsxs)("div",{style:S.tabs,children:[Object(s.jsx)("div",{style:Object(r.a)(Object(r.a)({},S.tab),{borderRightWidth:1,borderRightColor:"#d0d0d0"}),onClick:function(){return M("home")},children:Object(s.jsx)("div",{style:"home"===D?S.activeLabel:S.inactiveLabel,children:"Home"})}),Object(s.jsx)("div",{style:S.tab,onClick:function(){return M("logs")},children:Object(s.jsx)("div",{style:"logs"===D?S.activeLabel:S.inactiveLabel,children:"Logs"})}),Object(s.jsx)("div",{style:S.tab,onClick:function(){return M("setting")},children:Object(s.jsx)("div",{style:"setting"===D?S.activeLabel:S.inactiveLabel,children:"Setting"})})]})]})},S={container:{display:"flex",flexDirection:"column",flex:1,minHeight:"100vh"},content:{display:"flex",flex:1,backgroundColor:"#F5F5DC",height:"100%"},tabs:{display:"flex",flexDirection:"row",position:"fixed",letf:0,right:0,width:"100%",bottom:0,borderTop:"1px solid #d0d0d0"},tab:{display:"flex",flex:1,justifyContent:"center",padding:20,backgroundColor:"#f1f1f1"},activeLabel:{display:"flex",color:"green",fontWeight:"bold"},inactiveLabel:{display:"flex",color:"#444444"},scanningText:{display:"flex",fontSize:30},status:{backgroundColor:"black",color:"white",display:"flex",justifyContent:"space-between",padding:20},button:{}},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),i(e),c(e),a(e),o(e)}))};o.a.render(Object(s.jsx)(c.a.StrictMode,{children:Object(s.jsx)(y,{})}),document.getElementById("root")),C()}},[[17,1,2]]]);
//# sourceMappingURL=main.91f31b98.chunk.js.map